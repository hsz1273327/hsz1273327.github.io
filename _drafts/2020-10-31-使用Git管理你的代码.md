---
title: "使用Git管理你的代码"
date: 2020-10-31
author: "Hsz"
category: recommend
tags:
    - Git
    - DevOps
    - Git
header-img: "img/home-bg-o.jpg"
update: 2020-11-06
series:
    get_along_well_with_github:
        index: 3
---
# 使用Git管理你的代码

[Git](https://git-scm.com/)是当前最流行的一个开源的分布式版本控制系统,用于敏捷高效地处理任何或小或大的项目.

它是[Linus Torvalds](https://baike.baidu.com/item/%E6%9E%97%E7%BA%B3%E6%96%AF%C2%B7%E6%9C%AC%E7%BA%B3%E7%AC%AC%E5%85%8B%E7%89%B9%C2%B7%E6%89%98%E7%93%A6%E5%85%B9/1034429?fromtitle=Linus%20Torvalds&fromid=9336769&fr=aladdin)为了帮助管理[Linux](https://baike.baidu.com/item/Linux)内核开发而开发的一个开放源码的版本控制软件.

Git最大的特点是分布式.它与以往集中式的版本控制工具最大的不同就是Git的仓库是相互独立的,每个人电脑中都有完整的版本库,所以某人的机器挂了并不影响其它人.

这一特性天生对开源软件亲和.

## Git的工作流程

![Git的工作流程][1]

git版本控制系统由工作区,缓存区,版本库组成.它跟踪的是文件的修改而不是全部文件.也就是说它的版本控制靠的是记录变化.因此相比较起管理二进制文件,git更擅长管理代码等文本文件.

### 基本的版本控制

Git是分布式代码仓库,但如果只是本地使用也完全可以用于项目的版本控制.

但无论怎样你都需要先在本地创建一个代码仓库.

#### 创建一个git的项目仓库

```bash
git init
```

创建本地仓库后项目根目录下会生成一个`.git`的文件夹,其中`config`文件会记录仓库的一些基本信息.项目会有一个`HEAD`文件用于记录当前的状态.

这个`HEAD`会指向一个分支,一般是`master`分支,分支这个概念我们会在下一单元介绍.

#### 提交缓存

```bash
git add <path>
```

创建完成后就是写要管理的项目.我们需要向Git提交缓存变更才能让它记住.只有缓存了的代码才能被管理.我们可以使用`add`子命令将指定路径下的文件/文件夹的修改提交到缓存.为了方便,比较方便的方式是`git add .`

一般情况下我们会在确定没问题的情况下做`add`操作,但如果要取消缓存也不是没有办法可以使用如下命令

```bash
git reset HEAD <file>...
```

这条命令会将当前的缓存区中指定的文件缓存删除.

提交缓存的最佳实践是每次只在提交变更前提交缓存,这样就可以直接使用变更来管理版本.

#### 提交变更

```bash
git commit -m <message>
```

当多个缓存定型后我们可以提交一版修改到git,这步会生成了当前项目的一个快照,这个快照用一串字符串唯一标识(`commitID`),并将项目当前的`HEAD`指向这个提交的`commitID`.并将缓存区清空.

每次的提交都会包含如下信息:

+ `commitID`唯一标识
+ `Author`如果有设置的话
+ `Date`提交的日期
+ message 提交时附带的信息
+ 文件差异信息

> 查看指定快照的变更

这个信息只要不人工干预就不会被修改删除.依据这个我们可以得到一个由提交串起来的历史提交时间序列.如何查看提交历史呢?

```bash
git log
```

如果添加flag`-p -{n}`就可以查看每次提交所引入的差异,后面的`-{n}`是展示多少条

另一种方式是使用flag`--stat`,它可以看到每次提交的变化统计信息.其他还有几个flag可以用于设置展示形式这里就不详细介绍了,如果感兴趣可以看[这篇](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%9F%A5%E7%9C%8B%E6%8F%90%E4%BA%A4%E5%8E%86%E5%8F%B2).

> 回退到指定快照

由于每次的快照都会保存且有唯一标识,因此在本地我们可以随时回退到之前的某一次提交上.这就实现了版本控制.
比较常见的操作方式:

```bash
git reset --hard HEAD^ 回退到上个版本
git reset --hard HEAD~3 回退到前3次提交之前,以此类推回退到n次提交之前
git reset --hard <commitID> 退到/进到 指定commit
```

### 使用分支隔离代码

我们可以通过迁出分支来实现代码隔离,比如我们希望功能a和功能b同步开发,同时又担心开发过程中相互影响干扰,那么就可以迁出两个分支`a`和`b`.迁出的分支会指向迁出之前`commitID`.之后这个分支就时基于这次提交的修改了.

实际上仓库创建起来后就会默认创建一个`master`分支,无论后面迁出什么分支都可以认为根源上都是来自`master`分支,由于`Head`是指向分支再由分支保存最近的`commitID`的,所以在一个项目中可以每个分支保留自己的最终状态而不相互影响.

> 迁出分支


我们希望我们,合并不可避免的会带来冲突,因此合并步骤的主要工作也就是解决冲突.

合并完成后我们往往需要再次同步代码到没有冲突的版本.

多个合并

### 远程仓库同步


## 常见的工作流模板

### 主干分支策略

### githubflow

### gitflow

## 可视化工具Github Desktop

广为流行的版本控制工具git几乎已经成为行业标准,但其完全命令行操作的特点也确实难到了不少人.github公司开发的githubDesktop工具很好的解决了这个问题.目前该工具已经跨越全部桌面环境,去[官网下载](https://desktop.github.com/)对应版本按提示安装即可.

git命令其实也不复杂,但是作为工具我觉得直观可见是很好的特性,我想这也是github流行的原因吧.所以命令行党请退散~

进入正片

我们先来了解下他的各个部分按钮的作用

![按钮作用][1]

### 项目

点击下左上角的`+`号后会看到这样的:

![创建项目][2]

根据你的需求选择是怎样的创建方式

创建完了之后就是描述和确定版本了,如果需要的话也可以上传去github

### 分支

这个概念可能不太常见,一个项目可以有不同的版本,这些版本可能各具特点,这就是分支的概念了.创建分支也是简单的点击取个名字而已.


[1]: {{site.url}}/img/in-post/git/gitworkprocess.webp
[10]: {{site.url}}/img/in-post/git/gitdesktop_global.png
[11]: {{site.url}}/img/in-post/git/githubdesktop_project.png
